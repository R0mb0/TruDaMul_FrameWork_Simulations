\documentclass[13pt,a4paper]{article}
\usepackage[italian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{imakeidx}
%\usepackage{}


\title{ Implementazione  e Analisi "TruDaMul Framework".}
\author{Francesco Rossi \\
				Francesco Rombaldoni}
\date{}
\makeindex

\begin{document}
	\maketitle
	\newpage
	
	\index{generate}
	\newpage
	
	\section{Obiettivo del  lavoro.}
	L'obiettivo del lavoro è stato quello di verificare alcune proprietà del "TruDaMul Framework" tramite una implementazione semplificata dello stesso, realizzata con l'ausilio del linguaggio "NuSMV".\\
	
	\section{Svolgimento del lavoro e strumenti usati}
	Il lavoro è stato svolto aprendo una "repositiry" su "GitHub" alla quale ci si è interfacciati utilizzando il programma "GitHubDesktop". La "repository" (da ora chiamata semplicemente "repo") è stata poi suddivisa in tre "branch", in ordine: "main branch" è stato usato per ospitare la presentazione del progetto e in conclusione il "merging" con il "branch" contenente la versione del "Framework" più rifinita; il "Case Base branch" è stato usato per ospitare una implementazione base del "Framework", dalla quale successivamente sono stati fatti ulteriori "brach" per la costruzione di casi più specifici da testare; l'ultimo "branch", chiamato "Relation" è servito per ospitare la relazione. \bigskip \\
	Terminata l'organizzaione della "repo", si è passati ad installare i programmi necessari per lo sviluppo del "Framework" con i relativi test e per la scrittura della relazione in \LaTeX. In Particolare per poter disporre di un ambiente integrato per lo sviluppo del "Framework" è stato installato il "JDK di Java" per fare in modo di installare successivamente "Eclipse" con l'estenzione "NuSMV"; per fare in modo di eseguire il "Framework" è stata scaricata l'applicazione per "Bash" di "NuSMV"; infine per scrivere la relazione in \LaTeX è stato installato "TeX Live" e "TeXstudio", rispettivamente per compilare e per scrivere.\\
	Una volta aver terminato di scrivere la presentazione del progetto si è passati alla implementazione  del caso base, definendo i comportamenti ed il numero minimo degli attori, oltre che le prime proprietà da verificare. Il passo successivo è stato quello di creare un nuovo "branch" a partire dal caso base, in maniera tale da poter specializzare quest'ultimo per la costruzione di  casi specifici futuri, che saranno a loro volta dei "branch".\\
	 
	
	\section{Descrizione del 'Caso Base'}
	\subsection{Attori}
	Il caso base si compone dei seguenti attori: 
	\begin{itemize}
		\item un Clinet.
		\item due Muli.
		\item un Proxy.
		\item un Server,.
	\end{itemize}
	
	\subsection{Descrizione degli attori}
	\begin{itemize}
		\item Il Client che è in grado di comunicare soltanto con i Muli è composto dai seguenti elementi:
				  \begin{itemize}
					\item Una variabile "State" che può assumere i seguenti valori:
							\begin{itemize}
								\item "Null" se il Client non ha un messaggio da inviare.
								\item "Request" se il Client ha un messaggio da inviare.
								\item "According" se il Client sta contrattando il prezzo del lavoro con il Mulo.
								\item "Waiting" se il Client ha inviato il messaggio (dopo aver pagato il Mulo) e sta aspettando di ricevere una risposta.
								\item "Response" se un Mulo ha consegnato al CLient una risposta.
								\item "Payment" se il Client ha pagato il Mulo per avergli consegnato la risposta
							\end{itemize}
						\item Una variabile "Wallet" che contiene i soldi che il Client può spendere per assoldare i Muli.
						\item Una variabile "Choice" che contiene l'id del Mulo a cui è stato affidato il messaggio, vale zero se il Client non ha  affidato il messaggio ad un Mulo.
						\item Un comportamento che modificano la variabile "State":
						\begin{itemize}
							\item Inizialmente la variabile è inizializzata con lo stato "Null".
							\item Il Client entra nello stato "Request" quando decide (in maniera non predicibile) che vuole mandare un messaggio.
							\item Il Client entra nello stato di "According" quando ha un messaggio da spedire e un Mulo è nella sua zona.
							\item Il Client entra nello stato di "Response" se precedentemente ha inviato un messaggio e se un Mulo nelle sue vicinanze li consegna la risposta.
							\item Il Client entra nello stato di "Waiting" quando ha consegnato un messaggio ad un Mulo dopo averlo pagato. 
							\item Il Client entra nello stato di "Payment" quando vuole vedere la risposta che li è stata consegnata da un Mulo.
							\item Una volta aver ricevuto la risposta la variabile "State" viene ripristinata al valore di partenza.
							\end{itemize}
						\item La variabile "Wallet" viene decrementata ad ogni pagamento effettuato dal Client.
						\item Un comportamento che modifica la variabile "Choice":
						\begin{itemize}
							\item La variabile vale 0 il Client non ha consegnato nessun messaggio.
							\item La variabile vale 1 se  il CLient ha assoldato il Mulo 1.
							\item La variabile vale 2 se  il CLient ha assoldato il Mulo 2.
							\item Nel caso in cui entrambi i Muli siano in prossimità del Client la variabile assume un valore non deterministico tra 1 e 2.
							\item Una volta aver ricevuto la risposta la variabile viene ripristinata a 0.
						\end{itemize}
					\end{itemize}
				Il Client  è un attore che trovandosi in una condizione di isolamento dalla rete e avendo necessità do mandare un messaggio al server, assolda un Mulo (sotto compenso) per spedire il messaggio. Una volta aver pagato il Mulo ed averli consegnato il messaggio, il Client aspetta una risposta dal Server, la quale dovrà essere consegnata da un Mulo (non necessitante deve essere lo stesso che ha preso in carico il messaggio), il quale dovrà essere pagato dal Client per poter mostrare la risposta del Server.
				
		
		\item I Muli che sono in grado di comunicare con il Client e con il Proxye che inoltre conoscono il proprio codice identificativo sono composti da:
		\begin{itemize}
			\item una variabile "State" che può assumere i seguenti valori:
			\begin{itemize}
				\item "Walking" se il Mulo è in cerca di un lavoro e cammina in modo causale tra il Proxy ed il Client.
				\item "TalkingToC" se il Mulo è nella fase di contrattazione con il Client.
				\item "TalkingToP" se il mulo è nella fase di contrattazione con il Proxy.
				\item "GoingToC" se il Mulo si sta dirigendo verso il Client per la consegna della risposta data dal Proxy.
				\item "GoingToP" se il Mulo si sta dirigendo verso il Proxy per consegnare il messaggio del Client.
				\item "DeliverToC" se il Mulo ha consegnato la risposta al Client.
				\item "DeliverToP" se il Mulo ha consegnato il messaggio al Proxy.
				\item "Wait" se il Mulo attende di essere pagato dal Client.
			\end{itemize}
		\item Una variabile "Wallet" che contiene si soldi che il Mulo guadagna.
		\item Una variabile "Posiction" che può assumere i seguenti valori.
		\begin{itemize}
			\item "Client" se il Mulo si trova in prossimità del Client.
			\item "Middle" se il Mulo si trova tra il Client ed il Proxy.
			\item "Proxy" se il Mulo si trova in prossimità del Proxy.
		\end{itemize}
	\item Un comportamento che modifica la variabile "State":
	\begin{itemize}
		\item Inizialmente la variabile è inizializzata con lo stato "Walking".
		\item Il Mulo entra in modalità "TalkingToC" se si trova in prossimità del Client e quest'ultimo ha un messaggio da inviare.
		\item Il Mulo entra in modalità "TalkingToP" se si trova in prossimità del Proxy e quest'ultimo ha una risposta da inviare.
		\item Il Mulo entra nello stato "GoingToC" e successivamente nello stato "Walking" se è stato assoldato dal Client.
		\item Il Mulo entra nello stato "GoingToP" e successivamente nello stato "Walking" se è stato assoldato dal Proxy.
		\item Il Mulo entra nello stato "DeliverToC" se dopo aver raggiunto il Client, li consegna la risposta.
		\item Il Mulo entra nello stato "DeliverToP" se dopo aver raggiunto il Proxy, li consegna il messaggio.
		\item Il Mulo entra nello stato "Wait" se deve essere pagato dopo aver consegnato la risposta al Client.
		\item Alla fine del lavoro la variabile "State" viene ripristinata al valore di partenza.
	\end{itemize}
	\item La variabile "Wallet" viene incrementata ogni volta che il mulo viene pagato.
	\item Un comportamento che modifica la variabile "Posiction":
	\begin{itemize}
		\item Se il Mulo è nello stato "Walking" la variabile può assumere in modo non predicibile uno dei tre valori precedentemente elencati. 
		\item Se il Mulo deve dirigersi verso il "Proxy", la variabile assume il valore "Proxy".
		\item Se il Mulo deve dirigersi verso il "Client", la variabile assume il valore "Client".
	\end{itemize}
		\end{itemize}
		Il compito dei Muli è  quello di mettere in comunicazione il Client con il Proxy e vice versa, questa cosa la fanno grazie alla loro capacità di prendere un messaggio e di consegnarlo al destinatario. I Muli si muovono casualmente tra il Client ed il Proxy, in attesa di ricevere un messaggio da consegnare. I Muli si fanno pagare per il loro lavoro esclusivamente dal Client; infatti il Mulo si fa pagare dal Client prima di ritirare un messaggio da consegnare e nel caso in cui il mulo consegni al Client una risposta data dal Server, il Client dovrà pagare il mulo per poter vedere la risposta.
		
		
		\item Il Proxy che è in grado di comunicare soltanto con i Muli e con il Server è composto dai seguenti elementi: 
		\begin{itemize}
			\item Una variabile "State" che può assumere i seguenti valori:
			\begin{itemize}
				\item "Null" se il Proxy è in attesa di ricevere un messaggio
				\item "Messagge" quando il Proxy ha ricevuto un messaggio da un Mulo.
				\item "Forward" quando il Proxy ha inoltrato il messaggio al Server.
				\item "Wait" quando il Proxy è in attesa di ricevere una risposta dal Server.
				\item "Response" quando il Proxy ha ricevuto la risposta dal Server.
				\item "WaitingMule" quando il Proxy è in attesa di un Mulo a cui consegnare la riposta. 
				\item "According" quando il Proxy sta assoldando un Mulo.
			\end{itemize}
		\item Una variabile "Choice" che contiene l'id del Mulo a cui è stato affidato la risposta, vale zero se il Proxy non ha  affidato la risposta ad un Mulo.
		\item Un comportamento che modifica la variabile "State":
		\begin{itemize}
			\item Inizialmente la variabile viene inizializzata con lo stato "Null".
			\item Il Proxy entra nello stato "Message" se ha ricevuto un messaggio da un Mulo.
			\item Il Proxy entra nello stato "Forward" quando sta per inoltrare il messaggio al Server.
			\item Il Proxy entra nello stato "Wait" quando ha inoltrato il messaggio al Server.
			\item Il Proxy entra nello stato "Response" quando il Server ha inoltrato la risposta.
			\item Il Proxy entra nello stato "WaitingMule" quando aspetta un Mulo per inoltrargli la risposta data dal Server.
			\item Il Proxy entra nello stato "Acording" quando un Mulo si trova in prossimità del Proxy.
			\item Una volta aver inoltrato la risposta ad un Mulo la variabile ritorna allo stato di partenza.
		\end{itemize}
	\item Un comportamento che modifica la variabile "Choice":
	\begin{itemize}
		\item La variabile vale 0 il Proxy non ha consegnato nessun messaggio.
		\item La variabile vale 1 se  il Proxy ha assoldato il Mulo 1.
		\item La variabile vale 2 se  il Proxyent ha assoldato il Mulo 2.
		\item Nel caso in cui entrambi i Muli siano in prossimità del Proxy la variabile assume un valore non deterministico tra 1 e 2.
		\item Una volta aver inoltrato la risposta la variabile viene ripristinata a 0.
	\end{itemize}
		\end{itemize}
	Il compito del Proxy è quello di inoltrare al Server il messaggio del Client che i Muli gli hanno consegnato. Una volta aver inoltrato il messaggio al Server, il Proxy, rimane in attesa che quest'ultimo gli inoltri la risposta da dover consegnare al Client che ha mandato il messaggio. Appena il Proxy riceve la risposta dal Server, resta in attesa di poter inoltrare la risposta ad un Mulo, il quale la dovrà poi recapitare al Client.
		
		\item Il Server che è in grado solo di comunicare con il Proxy è composto dai seguenti elementi:
		\begin{itemize}
			\item Una variabile "State" che può assumere i seguenti valori:
			\begin{itemize}
				\item "Null" quando il Server è in attesa di ricevere un messaggio dal Proxy.
				\item "Messagge" quando il server ha ricevuto un messaggio dal Proxy.
				\item "Make" quando il Server sta preparando una risposta per il Proxy.
				\item "Forward" quando il Server ha inoltrato la risposta al Proxy.
			\end{itemize}
		\item Un comportamento che modifica la variabile "State"
		\begin{itemize}
			\item Inizialmente la variabile viene inizializzata con lo stato "Null".
			\item Il Server entra nello stato " Messagge" quando il Proxy gli ha inoltrato un messaggio.
			\item Il Server entra nello stato "Make" dopo aver ricevuto il messaggio dal server.
			\item Il Server entra nello stato "Response" quando sta per consegnare la risposta al Proxy.
			\item Il Server ritorna nello stato "Null" dopo aver inoltrato la risposta al Proxy.
		\end{itemize}
		\end{itemize}
	 Il compito del Server è quello di ricevere i messaggi dal Proxy, di elaborare una risposta e infine di inoltrare la risposta a quest'ultimo in modo che possa essere consegnata al Client.
	\end{itemize}

\subsection{Flusso di lavoro}
	\begin{enumerate}
	\item All'inizio i Muli camminano casualmente tra il Client ed il Proxy, in attesa che qualcuno abbia bisogno di loro per consegnare un messaggio.
	
	\item Se il Client ha bisogno di un Mulo per mandare un messaggio, entra nella modalità di richiesta, rimanendo in attesa di un Mulo a cui poter affidare il messaggio.
	
	\item Quando un Mulo raggiunge la zona del Client, controlla se quest'ultimo vuole inoltrare un messaggio, nel caso in cui la risposta è positiva può iniziare la fase di scambio, dove il Client paga il Mulo consegnandoli il messaggio da inoltrare al Proxy.
	
	\item Il Mulo cammina in maniera causale fino al raggiungimento del Proxy.
	
	\item Il Mulo consegna il messaggio al Proxy e successivamente ricomincia a muoversi casualmente tra il Proxy ed il Client.
	
	\item Quando il Proxy riceve il messaggio, lo inoltra al Server e attende una risposta da quest'ultimo .
	
	\item Quando il Server riceve un messaggio dal Proxy, inizia a elaborare una risposta da dover inoltrare a quest'ultimo.
	
	\item Quando il Proxy ha ricevuto la risposta dal Server entra in modalità richiesta, attendendo il passaggio  di un Mulo a cui poter inoltrare la risposta da dover consegnare al Client. 
	
	\item Una volta che il Mulo è nella zona del Proxy, controlla se quest'ultimo ha un messaggio da inviare al Client, se la risposta è affermativa, allora il mulo si prendere carico della risposta da consegnare al Client. 
	
	\item Il Mulo continua a muoversi in maniera causale fino a raggiungere la zona del Client. 
	
	\item A questo punto il Client paga il Mulo per poter vedere la risposta.
	\end{enumerate}

\subsection{Test implementati}
\begin{itemize}
	\item È stato implementato il test per verificare se viene sempre soddisfatta la richiesta del Client, ovvero se il Client quando ha bisogno di inviare un messaggio viene sempre servito e se riceve sempre la risposta formulata dal Server.\\
	Il risultato dimostra che siccome i muli si muovono in maniera causale, potrebbero non arrivare mai dal Client, come anche dal Proxy, motivo per cui il Client potrebbe non venire sempre servito oppure potrebbe non ricevere la risposta da Server.
	\item È stato implementato un test per verificare che il portafoglio del Client possa scendere sotto lo 0 durante l'esecuzione.\\
	Il risultato mostra che se il Client non ha più soldi con cui assoldare i Muli, allora rimane sempre nello stato in cui non deve mandare un messaggio.
	\item È stato implementato un test per verificare se durante una esecuzione soltanto uno dei due Muli è stato scelto dal Client per fare tutte le consegne.\\
	Il risultato dimostra che siccome la scelta del Mulo non è predicibile allora può accadere in un caso estremo che soltanto un Mulo esegue tutte le consegne.
	\item È stato implementato un test per verificare se quando il Client entra nello stato di richiesta di un Mulo, la sua richiesta viene sempre soddisfatta.\\
	il risultato dimostra che il caso di richiesta il Client viene sempre soddisfatto.
	
\end{itemize}
	
	\end{document}